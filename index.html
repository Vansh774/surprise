<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Valentine‚Äôs Surprise ‚Äî endless hearts shower üíï</title>
  <!-- Google Fonts: elegant romantic pairing -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Quicksand:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* -------------------------------
       üå∏ GLOBAL RESET ‚Äì PERFECT MOBILE
       soft pinks, red, pastel gradients, glow 
       RESPONSIVE with touch-friendly sizing
    ------------------------------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Quicksand', sans-serif;
      background: radial-gradient(circle at 30% 20%, #ffdde1, #f9c9d0, #ffb6bb);
      color: #5a1e2a;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      position: fixed;
      -webkit-overflow-scrolling: touch;
    }

    /* main container ‚Äì layer wrapper */
    .layers {
      position: relative;
      width: 100%;
      height: 100vh;
    }

    .layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1.5rem;
      opacity: 0;
      visibility: hidden;
      transition: opacity 1s cubic-bezier(0.25, 0.46, 0.45, 0.94), visibility 0s 1s;
      backdrop-filter: blur(3px);
      will-change: opacity, visibility;
      overflow-y: auto;
    }

    .layer.active {
      opacity: 1;
      visibility: visible;
      transition: opacity 1s cubic-bezier(0.23, 1, 0.32, 1), visibility 0s 0s;
      z-index: 10;
    }

    /* ---------- FLOATING HEART BACKGROUND (soft glow) ---------- */
    .floating-hearts {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .heart {
      position: absolute;
      color: rgba(255, 105, 180, 0.3);
      font-size: 2rem;
      animation: floatUp 18s infinite ease-in-out;
      text-shadow: 0 0 20px rgba(255, 80, 140, 0.8);
      user-select: none;
    }

    @keyframes floatUp {
      0% { transform: translateY(110vh) scale(0.7); opacity: 0.5; }
      100% { transform: translateY(-10vh) scale(1.4); opacity: 0; }
    }

    /* CONTINUOUS HEARTS SHOWER - new class for endless hearts */
    .heart-shower {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9998;
      overflow: hidden;
    }

    .shower-heart {
      position: absolute;
      color: #ff4d6d;
      font-size: 2rem;
      animation: showerFall 8s linear forwards;
      text-shadow: 0 0 30px #ff80a0, 0 0 60px #ffb3c6;
      user-select: none;
      z-index: 9999;
      opacity: 0.9;
      filter: drop-shadow(0 0 15px hotpink);
    }

    @keyframes showerFall {
      0% {
        transform: translateY(-20vh) translateX(0) rotate(0deg) scale(0.8);
        opacity: 1;
      }
      100% {
        transform: translateY(120vh) translateX(20px) rotate(360deg) scale(1.5);
        opacity: 0;
      }
    }

    /* rest of your existing styles remain exactly the same */
    h1, h2, h3, p {
      font-family: 'Cormorant Garamond', serif;
      letter-spacing: 1px;
      text-shadow: 0 0 25px rgba(255, 200, 220, 0.9);
    }

    .romantic-btn {
      background: rgba(255, 230, 240, 0.8);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1.5px solid #ffa5b0;
      padding: 16px 40px;
      font-size: 1.5rem;
      border-radius: 60px;
      color: #9f2b3c;
      font-weight: 600;
      box-shadow: 0 12px 30px rgba(255, 80, 120, 0.4), 0 0 40px #ffb6c1;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Quicksand', sans-serif;
      letter-spacing: 3px;
      margin-top: 25px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      border: none;
      outline: none;
      transform: scale(1);
      width: auto;
      min-width: 220px;
      -webkit-appearance: none;
    }

    .romantic-btn:active {
      background: #ff9eb5;
      color: white;
      box-shadow: 0 0 50px #ff8caa;
      transform: scale(0.96);
    }

    .typewriter {
      font-size: clamp(2.2rem, 10vw, 3.8rem);
      font-weight: 600;
      text-align: center;
      color: #871c2c;
      margin-bottom: 20px;
      min-height: 150px;
      text-shadow: 0 0 20px #ffe2e8;
      line-height: 1.2;
      word-break: break-word;
    }

    .bounce-in {
      animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55) both;
    }

    @keyframes bounceIn {
      0% { opacity: 0; transform: scale(0.3); }
      50% { opacity: 1; transform: scale(1.08); }
      100% { transform: scale(1); }
    }

    .love-meter-container {
      background: rgba(255, 245, 250, 0.6);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 30px 20px;
      border-radius: 60px 20px 60px 20px;
      box-shadow: 0 25px 40px rgba(180, 0, 60, 0.2);
      width: 95%;
      max-width: 550px;
      border: 1px solid rgba(255, 220, 240, 0.9);
      margin: 0 auto;
    }

    .love-meter-container h2 {
      font-size: clamp(1.8rem, 6vw, 2.5rem);
      margin-bottom: 20px;
    }

    .heart-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 20px;
      background: linear-gradient(90deg, #ffb3c6, #ff6f91);
      border-radius: 30px;
      outline: none;
      margin: 20px 0 30px;
      box-shadow: 0 0 30px #ff8caa;
    }

    .heart-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 58px;
      height: 58px;
      background: #ff4d6d;
      border-radius: 50%;
      box-shadow: 0 0 40px #ff1e4d, 0 0 80px #ff8a9f;
      border: 4px solid white;
      cursor: pointer;
      transition: 0.1s;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>');
      background-size: 55%;
      background-position: center 55%;
      background-repeat: no-repeat;
    }

    .heart-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    .love-percent {
      font-size: clamp(2.2rem, 8vw, 2.8rem);
      font-weight: 700;
      color: #b33951;
      text-shadow: 0 0 35px #ffc2c9;
    }

    .heartbeat-active {
      animation: heartbeat 0.9s infinite ease-in-out;
    }

    @keyframes heartbeat {
      0% { transform: scale(1); }
      30% { transform: scale(1.2); }
      50% { transform: scale(1.1); }
      70% { transform: scale(1.25); }
      100% { transform: scale(1); }
    }

    #heartBeatIcon {
      font-size: clamp(2.8rem, 10vw, 3.5rem);
      filter: drop-shadow(0 0 20px red);
    }

    .dramatic-reveal h1 {
      font-size: clamp(2.4rem, 7vw, 4rem);
      line-height: 1.2;
    }

    .slideshow {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #ffd9de;
      overflow: hidden;
    }

    .slide-img {
      position: absolute;
      width: min(90%, 600px);
      height: min(70%, 400px);
      object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      opacity: 0;
      transition: opacity 1.8s ease;
      will-change: opacity, transform;
    }

    @media (min-width: 601px) and (max-width: 1024px) {
      .slide-img {
        width: 85%;
        height: 85%;
      }
    }

    .slide-img.active {
      opacity: 1;
      z-index: 15;
      animation: kenburns 10s ease infinite alternate;
    }

    @keyframes kenburns {
      0% { transform: scale(1); }
      100% { transform: scale(1.15); }
    }

    .music-control {
      position: fixed;
      bottom: 25px;
      right: 20px;
      background: rgba(255, 220, 240, 0.9);
      border-radius: 60px;
      padding: 16px 26px;
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
      border: 1.5px solid white;
      font-size: 1.5rem;
      color: #a13e4b;
      z-index: 999;
      cursor: pointer;
      transition: 0.2s;
      font-weight: 600;
      box-shadow: 0 5px 20px rgba(200,0,80,0.2);
      letter-spacing: 2px;
      display: flex;
      align-items: center;
      gap: 8px;
      opacity: 0;
      pointer-events: none;
    }

    .music-control.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .music-control:active {
      background: #ffc0cb;
      transform: scale(0.94);
    }

    .final-love-message {
      font-size: clamp(3rem, 12vw, 5.5rem);
      color: #fb6f92;
      animation: slowHeartbeat 3.2s infinite;
      text-shadow: 0 0 50px #ffa7b3, 0 0 20px white;
      line-height: 1.2;
      text-align: center;
      padding: 0 10px;
    }

    @keyframes slowHeartbeat {
      0% { transform: scale(1); }
      30% { transform: scale(1.1); }
      60% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    #finalLoveMessage {
      width: 100%;
      padding: 20px;
    }

    #teaseMessage {
      font-size: 1.6rem;
      min-height: 60px;
    }

    @media (max-width: 380px) {
      .romantic-btn {
        padding: 14px 25px;
        font-size: 1.3rem;
        min-width: 180px;
      }
      .love-meter-container {
        padding: 20px 15px;
      }
      .heart-slider::-webkit-slider-thumb {
        width: 52px;
        height: 52px;
      }
    }

    @media (orientation: landscape) and (max-height: 500px) {
      .layer {
        justify-content: flex-start;
        padding-top: 15px;
      }
      .typewriter {
        font-size: 2rem;
        min-height: 80px;
      }
    }

    .hide { display: none; }
  </style>
</head>
<body>
  <!-- floating hearts background (global) -->
  <div class="floating-hearts" id="floatingHearts"></div>
  
  <!-- CONTINUOUS HEARTS SHOWER container - will be filled when layer 4 opens -->
  <div id="heartShower" class="heart-shower"></div>

  <!-- music control -->
  <div id="musicToggle" class="music-control">üîä Unmute</div>

  <!-- main layers container -->
  <div class="layers">
    <!-- LAYER 1 ‚Äì OPENING SCREEN -->
    <div id="layer1" class="layer active">
      <div class="typewriter" id="heroText"></div>
      <div id="continueBtnContainer" style="min-height: 100px; display: flex; justify-content: center;">
        <button id="continueBtn1" class="romantic-btn" style="display: none;">Continue ‚ù§Ô∏è</button>
      </div>
    </div>

    <!-- LAYER 2 ‚Äì LOVE METER -->
    <div id="layer2" class="layer">
      <div class="love-meter-container">
        <h2 style="font-weight: 600; text-align: center;">How Much Do You Love Me? üíï</h2>
        <input type="range" min="0" max="100" value="0" id="loveSlider" class="heart-slider">
        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; flex-wrap: wrap; gap: 10px;">
          <span id="lovePercentDisplay" class="love-percent">0% Love ‚ù§Ô∏è</span>
          <span id="heartBeatIcon" style="font-size: 3.2rem; filter: drop-shadow(0 0 15px red);">‚ù§Ô∏è</span>
        </div>
        <button id="tellMeBtn" class="romantic-btn" style="margin-top: 35px; display: none;">Tell Me ‚ù§Ô∏è</button>
        <div id="teaseMessage" style="font-size: 1.5rem; margin-top: 20px; color: #b23b4a; font-weight: 600; text-align: center;"></div>
      </div>
    </div>

    <!-- LAYER 3 ‚Äì TRUE LOVE UNLOCK -->
    <div id="layer3" class="layer">
      <div class="dramatic-reveal" style="text-align: center; padding: 20px;">
        <h1 style="font-size: clamp(2.6rem, 8vw, 4rem); margin-bottom: 25px; color: #962d3e;">Only true love unlocks this üíñ</h1>
        <button id="memoriesBtn" class="romantic-btn" style="font-size: 1.8rem;">See Our Memories ‚ú®</button>
      </div>
    </div>

    <!-- LAYER 4 ‚Äì MEMORY SLIDESHOW + FINAL SURPRISE -->
    <div id="layer4" class="layer" style="justify-content: center; padding: 0;">
      <div class="slideshow" id="slideshowContainer" style="width: 100vw; height: 100vh; position: relative;">
        <!-- images injected via JS -->
      </div>
      <!-- final large message -->
      <div id="finalLoveMessage" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 200; width: 100%; text-align: center; opacity: 0; transition: opacity 2.8s; pointer-events: none;">
        <div class="final-love-message">I Love You So Much ‚ù§Ô∏è</div>
      </div>
    </div>
  </div>

  <!-- audio element -->
  <audio id="bgMusic" loop playsinline webkit-playsinline>
    <source src="audio/jabtak_427a91d54753145.mp3" type="audio/mpeg">
  </audio>

  <script>
    (function(){
      "use strict";

      // GLOBAL DATA & ELEMENTS
      const layers = {
        1: document.getElementById('layer1'),
        2: document.getElementById('layer2'),
        3: document.getElementById('layer3'),
        4: document.getElementById('layer4')
      };
      const continueBtn = document.getElementById('continueBtn1');
      const heroTextEl = document.getElementById('heroText');
      const slider = document.getElementById('loveSlider');
      const percentDisplay = document.getElementById('lovePercentDisplay');
      const heartIcon = document.getElementById('heartBeatIcon');
      const tellMeBtn = document.getElementById('tellMeBtn');
      const teaseMsg = document.getElementById('teaseMessage');
      const memoriesBtn = document.getElementById('memoriesBtn');
      const musicToggle = document.getElementById('musicToggle');
      const audio = document.getElementById('bgMusic');
      const heartShower = document.getElementById('heartShower');

      let currentLayer = 1;
      let typed = false;
      let slideshowInterval = null;
      let photoIndex = 0;
      let musicStarted = false;
      let showerInterval = null;  // for continuous hearts

      // floating hearts generator
      function createHearts() {
        const heartsContainer = document.querySelector('.floating-hearts');
        for (let i = 0; i < 40; i++) {
          const heart = document.createElement('span');
          heart.className = 'heart';
          heart.innerHTML = '‚ù§Ô∏è';
          heart.style.left = Math.random() * 100 + '%';
          heart.style.animationDelay = Math.random() * 16 + 's';
          heart.style.fontSize = (Math.random() * 30 + 20) + 'px';
          heart.style.opacity = 0.2 + Math.random() * 0.35;
          heartsContainer.appendChild(heart);
        }
      }
      createHearts();

      // ‚úçÔ∏è LETTER-BY-LETTER ANIMATION
      function typeWriterEffect(text, element, speed = 85) {
        let i = 0;
        element.textContent = '';
        function type() {
          if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
            setTimeout(type, speed);
          } else {
            typed = true;
            continueBtn.style.display = 'inline-flex';
            continueBtn.classList.add('bounce-in');
          }
        }
        type();
      }

      typeWriterEffect('Happy Valentine‚Äôs Day My Love ‚ù§Ô∏è', heroTextEl, 90);

      // LAYER TRANSITIONS
      function goToLayer(layerId) {
        Object.values(layers).forEach(l => l.classList.remove('active'));
        document.getElementById(`layer${layerId}`).classList.add('active');
        currentLayer = layerId;
        
        if(layerId === 4) {
          startSlideshow();
          startContinuousHearts(); // START ENDLESS HEARTS HERE
        } else {
          stopContinuousHearts(); // STOP hearts when leaving layer 4
        }
      }

      // üéØ CONTINUOUS HEARTS SHOWER - runs forever once started
      function startContinuousHearts() {
        // Clear any existing interval
        if (showerInterval) clearInterval(showerInterval);
        
        // Create new hearts every 300ms (endless)
        showerInterval = setInterval(() => {
          createShowerHeart();
        }, 300);
        
        // Also create 10 hearts immediately for instant effect
        for (let i = 0; i < 10; i++) {
          setTimeout(() => createShowerHeart(), i * 100);
        }
      }

      function stopContinuousHearts() {
        if (showerInterval) {
          clearInterval(showerInterval);
          showerInterval = null;
        }
        // Clear existing shower hearts
        document.querySelectorAll('.shower-heart').forEach(h => h.remove());
      }

      function createShowerHeart() {
        const heart = document.createElement('span');
        heart.className = 'shower-heart';
        
        // Random heart emoji variation
        const hearts = ['‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'ü§ç', 'üíñ', 'üíó', 'üíì', 'üíû', 'üíï'];
        heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
        
        // Random position, size, and animation duration
        const left = Math.random() * 100;
        const size = 1 + Math.random() * 2; // 1rem to 3rem
        const duration = 5 + Math.random() * 8; // 5-13 seconds
        const delay = Math.random() * 2;
        
        heart.style.left = left + '%';
        heart.style.fontSize = (size * 1.2) + 'rem';
        heart.style.animation = `showerFall ${duration}s linear ${delay}s forwards`;
        
        // Random colors for variety
        const colors = ['#ff4d6d', '#ff6f91', '#ff8caa', '#ffb3c6', '#fb6f92', '#ff99aa'];
        heart.style.color = colors[Math.floor(Math.random() * colors.length)];
        
        heartShower.appendChild(heart);
        
        // Remove heart after animation completes
        setTimeout(() => {
          if (heart.parentNode) heart.remove();
        }, (duration + delay) * 1000);
      }

      // continue to layer2
      continueBtn.addEventListener('click', function() {
        if(typed) goToLayer(2);
      });

      // LOVE METER INTERACTIVE
      slider.addEventListener('input', function() {
        const val = slider.value;
        percentDisplay.textContent = `${val}% Love ‚ù§Ô∏è`;
        
        tellMeBtn.style.display = 'inline-flex';
        
        const beatSpeed = 1.3 - (val / 180); 
        heartIcon.style.animation = `heartbeat ${beatSpeed}s infinite ease-in-out`;
        if (val > 0) heartIcon.classList.add('heartbeat-active');
        
        if (val == 100) {
          triggerConfettiHearts();
          document.body.style.boxShadow = 'inset 0 0 100px #ffa5aa';
          document.body.style.transition = 'box-shadow 0.6s';
          heartIcon.style.animation = `heartbeat 0.45s infinite ease-in-out`;
          teaseMsg.innerHTML = '';
        } else {
          document.body.style.boxShadow = 'none';
        }
      });

      // CONFETTI HEARTS EXPLOSION
      function triggerConfettiHearts() {
        for (let i=0;i<60;i++) {
          const confettiHeart = document.createElement('span');
          confettiHeart.innerHTML = '‚ù§Ô∏è';
          confettiHeart.style.position = 'fixed';
          confettiHeart.style.left = Math.random() * 100 + '%';
          confettiHeart.style.top = '-5%';
          confettiHeart.style.fontSize = (Math.random()*26 + 16)+'px';
          confettiHeart.style.color = ['#ff99aa','#ff4d6d','#ffb3c6','#ff8fa3'][Math.floor(Math.random()*4)];
          confettiHeart.style.zIndex = '9999';
          confettiHeart.style.pointerEvents = 'none';
          confettiHeart.style.filter = 'drop-shadow(0 0 25px hotpink)';
          confettiHeart.style.animation = `floatUp ${4 + Math.random()*6}s ease-in forwards`;
          document.body.appendChild(confettiHeart);
          setTimeout(() => { confettiHeart.remove(); }, 7000);
        }
      }

      // TELL ME BUTTON LOGIC
      tellMeBtn.addEventListener('click', function() {
        const val = parseInt(slider.value, 10);
        if (val === 100) {
          teaseMsg.innerHTML = 'Awww‚Ä¶ I knew it ü•∞';
          teaseMsg.style.animation = 'bounceIn 0.7s';
          goToLayer(3);
        } else {
          teaseMsg.innerHTML = val > 70 ? 'So close, love! Try 100 üíï' : 'Hmm, give me 100%? ü•∫';
        }
      });

      // LAYER 3 ‚Üí LAYER 4 (memories) ‚Äî MUSIC STARTS
      memoriesBtn.addEventListener('click', function() {
        if (!musicStarted) {
          audio.muted = false;
          audio.play()
            .then(() => {
              musicStarted = true;
              musicToggle.classList.add('visible');
              musicToggle.innerHTML = 'üîá Mute';
              musicMuted = false;
            })
            .catch(error => {
              console.log('Playback failed:', error);
              musicToggle.classList.add('visible');
              musicToggle.innerHTML = 'üîä Unmute';
              musicMuted = true;
            });
        }
        goToLayer(4);
      });

      // MEMORY SLIDESHOW
      const memoryPhotos = [
        'image/devu.jpeg', 
        'image/vanshu.jpeg', 
        'image/devshu1.jpeg', 
        'image/devshu2.jpeg', 
        'image/devshu3.jpeg',
        'image/devshu4.jpeg',  
      ];

      function startSlideshow() {
        const container = document.getElementById('slideshowContainer');
        container.innerHTML = '';
        
        memoryPhotos.forEach((src, idx) => {
          const img = document.createElement('img');
          img.src = src;
          img.alt = 'memory';
          img.className = 'slide-img';
          if (idx === 0) img.classList.add('active');
          container.appendChild(img);
        });

        photoIndex = 0;
        if (slideshowInterval) clearInterval(slideshowInterval);
        
        slideshowInterval = setInterval(() => {
          const imgs = document.querySelectorAll('.slide-img');
          if (imgs.length === 0) return;
          imgs.forEach(img => img.classList.remove('active'));
          photoIndex = (photoIndex + 1) % imgs.length;
          imgs[photoIndex].classList.add('active');

          if (photoIndex === imgs.length - 1) {
            setTimeout(() => {
              const finalMsgDiv = document.getElementById('finalLoveMessage');
              finalMsgDiv.style.opacity = '1';
              document.body.style.background = 'radial-gradient(circle at 50% 50%, #ffcdd4, #fbaab3, #ff8595)';
            }, 2000);
          }
        }, 2000);
      }

      // MUSIC CONTROL
      let musicMuted = true;
      
      musicToggle.addEventListener('click', function() {
        if (musicMuted) {
          audio.muted = false;
          audio.play().catch(() => {}); 
          musicToggle.innerHTML = 'üîá Mute';
        } else {
          audio.muted = true;
          audio.pause();
          musicToggle.innerHTML = 'üîä Unmute';
        }
        musicMuted = !musicMuted;
      });

      audio.muted = true;
      audio.pause();

      // initial heartbeat style
      heartIcon.style.animation = `heartbeat 1.2s infinite ease-in-out`;

    })();
  </script>
</body>
</html>